---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Badge from '@/components/ui/Badge.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const projects = await getCollection('work');
  return projects.map(project => ({
    params: { slug: project.slug },
    props: { project },
  }));
}

const { project } = Astro.props;
const { Content } = await project.render();
const { title, year, tagline, company, tags, metrics } = project.data;
---
<BaseLayout title={`${title} — Amey Bhavsar`} description={tagline} active="work">
  <div class="px-5 md:px-8 py-20 pb-16 border-b border-border max-w-4xl mx-auto">
    <a href="/#projects" class="inline-flex items-center gap-2 font-mono text-sm text-muted-foreground tracking-widest mb-12 transition-all hover:text-foreground hover:-translate-x-1 magnetic">
      <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
        <path d="M11 7H3M3 7l4-4M3 7l4 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Back to projects
    </a>
    <div class="font-mono text-xs tracking-widest text-muted-foreground uppercase mb-6">{company} · {year}</div>
    <h1 class="font-display font-bold text-4xl md:text-5xl lg:text-6xl tracking-tight text-foreground leading-tight mb-4 text-balance">{title}</h1>
    <p class="text-lg text-muted-foreground font-light mb-10 leading-relaxed">{tagline}</p>

    <!-- Metrics row -->
    <div class="border border-border max-w-md">
      <div class="grid grid-cols-3 gap-px bg-border">
        {metrics.map((m: { value: string; label: string }) => (
          <div class="bg-card p-5 transition-colors hover:bg-muted">
            <div class="font-display font-bold text-3xl md:text-4xl tracking-tight text-foreground mb-1">{m.value}</div>
            <div class="font-mono text-xs tracking-widest text-muted-foreground uppercase">{m.label}</div>
          </div>
        ))}
      </div>
    </div>

    <!-- Tags -->
    <div class="flex flex-wrap gap-2 mt-8">
      {tags.map((tag: string) => (
        <Badge size="sm">{tag}</Badge>
      ))}
    </div>
  </div>

  <div class="max-w-4xl mx-auto px-5 md:px-8 py-16 pb-32">
    <div class="prose-body">
      <Content />
    </div>
  </div>
</BaseLayout>
